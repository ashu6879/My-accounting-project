import{r,u as S,j as e,T as w,F as A}from"./index-DjrlQ2F5.js";import{u as E,T as l,S as N}from"./useAuth-DvVyDevX.js";import{L as T}from"./LoadingButton-CeD71zW5.js";import{C as W,S as g,A as C}from"./Snackbar-CFecR7nN.js";import{I as D}from"./OutlinedInput-DsoeenSI.js";import{M as I}from"./MenuItem-CowiRKKG.js";import"./CircularProgress-BMgE6Vjs.js";const k=()=>{const[n,m]=r.useState({clientName:"",clientAddress:"",clientPhone:"",clientGst:"",clientEmail:"",clientCat:""}),[f,p]=r.useState([]),[o,s]=r.useState(""),[c,u]=r.useState(""),[x,h]=r.useState(!1),{isAuthenticated:j,loading:v}=E(),y=S();r.useEffect(()=>{(async()=>{try{const a=await fetch("http://ec2-13-234-31-37.ap-south-1.compute.amazonaws.com:8181/clientcategories/all");if(!a.ok)throw new Error("Failed to fetch categories");const d=await a.json();p(d)}catch(a){s(a.message)}})()},[]);const i=t=>{m({...n,[t.target.name]:t.target.value})},b=async t=>{t.preventDefault(),h(!0);try{const a=await fetch("http://ec2-13-234-31-37.ap-south-1.compute.amazonaws.com:8181/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok){const d=await a.text();throw new Error(d||"Failed to add client")}u("Client added successfully!"),m({clientName:"",clientAddress:"",clientPhone:"",clientEmail:"",clientGst:"",clientCat:""}),setTimeout(()=>{y("/ManageClient/edit")},2e3)}catch(a){s(a.message)}finally{h(!1)}};return v?e.jsx("div",{children:"Loading..."}):j?e.jsxs(W,{maxWidth:"sm",children:[e.jsx(w,{variant:"h4",gutterBottom:!0,children:"Add Client"}),e.jsxs("form",{onSubmit:b,children:[e.jsx(l,{label:"Name",name:"clientName",variant:"outlined",fullWidth:!0,value:n.clientName,onChange:i,margin:"normal",required:!0}),e.jsx(l,{label:"Address",name:"clientAddress",variant:"outlined",fullWidth:!0,value:n.clientAddress,onChange:i,margin:"normal",required:!0}),e.jsx(l,{label:"Phone",name:"clientPhone",variant:"outlined",fullWidth:!0,value:n.clientPhone,onChange:i,margin:"normal",required:!0}),e.jsx(l,{label:"GST Number",name:"clientGst",variant:"outlined",fullWidth:!0,value:n.clientGST,onChange:i,margin:"normal"}),e.jsx(l,{label:"Email",name:"clientEmail",variant:"outlined",fullWidth:!0,value:n.clientEmail,onChange:i,margin:"normal",required:!0}),e.jsxs(A,{variant:"outlined",fullWidth:!0,margin:"normal",required:!0,children:[e.jsx(D,{id:"category-label",children:"Client Category"}),e.jsx(N,{labelId:"category-label",id:"clientCat",name:"clientCat",value:n.clientCat,onChange:i,label:"Client Category",children:f.map(t=>e.jsx(I,{value:t.ccID,children:t.ccName},t.ccID))})]}),e.jsx(T,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,loading:x,children:"Add Client"})]}),c&&e.jsx(g,{open:!!c,autoHideDuration:6e3,onClose:()=>u(""),children:e.jsx(C,{onClose:()=>u(""),severity:"success",sx:{width:"100%"},children:c})}),o&&e.jsx(g,{open:!!o,autoHideDuration:6e3,onClose:()=>s(""),children:e.jsx(C,{onClose:()=>s(""),severity:"error",sx:{width:"100%"},children:o})})]}):null};export{k as default};
